var sortable=function(){"use strict";function e(e,t,n){if(void 0===n)return e&&e.h5s&&e.h5s.data&&e.h5s.data[t];e.h5s=e.h5s||{},e.h5s.data=e.h5s.data||{},e.h5s.data[t]=n}var t,n,r,o,i,a,l,s,d,f=function(e,t){if(!(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array))throw Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.");return"string"!=typeof t?Array.from(e):Array.from(e).filter(function(e){return 1===e.nodeType&&e.matches(t)})},c=new Map,u=function(){function e(){this._config=new Map,this._placeholder=void 0,this._data=new Map}return Object.defineProperty(e.prototype,"config",{get:function(){var e={};return this._config.forEach(function(t,n){e[n]=t}),e},set:function(e){if("object"!=typeof e)throw Error("You must provide a valid configuration object to the config setter.");var t=Object.assign({},e);this._config=new Map(Object.entries(t))},enumerable:!1,configurable:!0}),e.prototype.setConfig=function(e,t){if(!this._config.has(e))throw Error("Trying to set invalid configuration item: "+e);this._config.set(e,t)},e.prototype.getConfig=function(e){if(!this._config.has(e))throw Error("Invalid configuration item requested: "+e);return this._config.get(e)},Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._placeholder},set:function(e){if(!(e instanceof HTMLElement)&&null!==e)throw Error("A placeholder must be an html element or null.");this._placeholder=e},enumerable:!1,configurable:!0}),e.prototype.setData=function(e,t){if("string"!=typeof e)throw Error("The key must be a string.");this._data.set(e,t)},e.prototype.getData=function(e){if("string"!=typeof e)throw Error("The key must be a string.");return this._data.get(e)},e.prototype.deleteData=function(e){if("string"!=typeof e)throw Error("The key must be a string.");return this._data.delete(e)},e}(),p=function(e){if(!(e instanceof HTMLElement))throw Error("Please provide a sortable to the store function.");return c.has(e)||c.set(e,new u),c.get(e)};function g(e,t,n){if(e instanceof Array){for(var r=0;r<e.length;++r)g(e[r],t,n);return}e.addEventListener(t,n),p(e).setData("event"+t,n)}function h(e,t){if(e instanceof Array){for(var n=0;n<e.length;++n)h(e[n],t);return}e.removeEventListener(t,p(e).getData("event"+t)),p(e).deleteData("event"+t)}function m(e,t,n){if(e instanceof Array){for(var r=0;r<e.length;++r)m(e[r],t,n);return}e.setAttribute(t,n)}function v(e,t){if(e instanceof Array){for(var n=0;n<e.length;++n)v(e[n],t);return}e.removeAttribute(t)}var y=function(e){if(!e.parentElement||0===e.getClientRects().length)throw Error("target element must be part of the dom");var t=e.getClientRects()[0];return{left:t.left+window.pageXOffset,right:t.right+window.pageXOffset,top:t.top+window.pageYOffset,bottom:t.bottom+window.pageYOffset}},b=function(e,t){var n;return void 0===t&&(t=0),function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];clearTimeout(n),n=setTimeout(function(){e.apply(void 0,r)},t)}},$=function(e,t){if(!(e instanceof HTMLElement)||!(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array))throw Error("You must provide an element and a list of elements.");return Array.from(t).indexOf(e)},w=function(e){if(!(e instanceof HTMLElement))throw Error("Element is not a node element.");return null!==e.parentNode},C=function(e,t,n){if(!(e instanceof HTMLElement)||!(e.parentElement instanceof HTMLElement))throw Error("target and element must be a node");e.parentElement.insertBefore(t,"before"===n?e:e.nextElementSibling)},E=function(t,n,r){if(void 0===n&&(n=function(e,t){return e}),void 0===r&&(r=function(e){return e}),!(t instanceof HTMLElement)||!0==!t.isSortable)throw Error("You need to provide a sortableContainer to be serialized.");if("function"!=typeof n||"function"!=typeof r)throw Error("You need to provide a valid serializer for items and the container.");var o=e(t,"opts").items,i=f(t.children,o),a=i.map(function(e){return{parent:t,node:e,html:e.outerHTML,index:$(e,i)}}),l={node:t,itemCount:a.length};return{container:r(l),items:a.map(function(e){return n(e,t)})}},T=function(e,t,n){var r;if(void 0===n&&(n="sortable-placeholder"),!(e instanceof HTMLElement))throw Error("You must provide a valid element as a sortable.");if(!(t instanceof HTMLElement)&&void 0!==t)throw Error("You must provide a valid element as a placeholder or set ot to undefined.");return void 0===t&&(["UL","OL"].includes(e.tagName)?t=document.createElement("li"):["TABLE","TBODY"].includes(e.tagName)?(t=document.createElement("tr")).innerHTML='<td colspan="100"></td>':t=document.createElement("div")),"string"==typeof n&&(r=t.classList).add.apply(r,n.split(" ")),t},x=function(e){if(!(e instanceof HTMLElement))throw Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return"border-box"===t.getPropertyValue("box-sizing")?parseInt(t.getPropertyValue("height"),10):["height","padding-top","padding-bottom"].map(function(e){var n=parseInt(t.getPropertyValue(e),10);return isNaN(n)?0:n}).reduce(function(e,t){return e+t})},D=function(e){if(!(e instanceof HTMLElement))throw Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return["width","padding-left","padding-right"].map(function(e){var n=parseInt(t.getPropertyValue(e),10);return isNaN(n)?0:n}).reduce(function(e,t){return e+t})},S=function(e,t){if(!(e instanceof Array))throw Error("You must provide a Array of HTMLElements to be filtered.");return"string"!=typeof t?e:e.filter(function(e){return e.querySelector(t) instanceof HTMLElement||e.shadowRoot&&e.shadowRoot.querySelector(t) instanceof HTMLElement}).map(function(e){return e.querySelector(t)||e.shadowRoot&&e.shadowRoot.querySelector(t)})},I=function(e){return e.composedPath&&e.composedPath()[0]||e.target},_=function(e,t,n){return{element:e,posX:n.pageX-t.left,posY:n.pageY-t.top}},L=function(e,t,n){if(!(e instanceof Event))throw Error("setDragImage requires a DragEvent as the first argument.");if(!(t instanceof HTMLElement))throw Error("setDragImage requires the dragged element as the second argument.");if(n||(n=_),e.dataTransfer&&e.dataTransfer.setDragImage){var r=y(t),o=n(t,r,e);if(!(o.element instanceof HTMLElement)||"number"!=typeof o.posX||"number"!=typeof o.posY)throw Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].");e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData("text/plain",I(e).id),e.dataTransfer.setDragImage(o.element,o.posX,o.posY)}},Y=function(e,t){if(!0===e.isSortable){var n=p(e).getConfig("acceptFrom");if(null!==n&&!1!==n&&"string"!=typeof n)throw Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.');if(null!==n)return!1!==n&&n.split(",").filter(function(e){return e.length>0&&t.matches(e)}).length>0;if(e===t)return!0;if(void 0!==p(e).getConfig("connectWith")&&null!==p(e).getConfig("connectWith"))return p(e).getConfig("connectWith")===p(t).getConfig("connectWith")}return!1},P={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:!1,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,dropTargetContainerClass:!1,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"},O=function(e,t){if("string"==typeof p(e).getConfig("hoverClass")){var n=p(e).getConfig("hoverClass").split(" ");!0===t?(g(e,"mousemove",function e(t,n){var r=this;if(void 0===n&&(n=250),"function"!=typeof t)throw Error("You must provide a function as the first argument for throttle.");if("number"!=typeof n)throw Error("You must provide a number as the second argument for throttle.");var o=null;return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var a=Date.now();(null===o||a-o>=n)&&(o=a,t.apply(r,e))}}(function(t){0===t.buttons&&f(e.children,p(e).getConfig("items")).forEach(function(e){var r,o;e===t.target||e.contains(t.target)?(r=e.classList).add.apply(r,n):(o=e.classList).remove.apply(o,n)})},p(e).getConfig("throttleTime"))),g(e,"mouseleave",function(){f(e.children,p(e).getConfig("items")).forEach(function(e){var t;(t=e.classList).remove.apply(t,n)})})):(h(e,"mousemove"),h(e,"mouseleave"))}},z=function(e){h(e,"dragstart"),h(e,"dragend"),h(e,"dragover"),h(e,"dragenter"),h(e,"drop"),h(e,"mouseenter"),h(e,"mouseleave")},W=function(e,t){e&&h(e,"dragleave"),t&&t!==e&&h(t,"dragleave")},A=function(e,t){var n=e;return!0===p(t).getConfig("copy")&&(m(n=e.cloneNode(!0),"aria-copied","true"),e.parentElement.appendChild(n),n.style.display="none",n.oldDisplay=e.style.display),n},F=function(e){var t;(t=e).h5s&&delete t.h5s.data,v(e,"aria-dropeffect")},q=function(e){v(e,"aria-grabbed"),v(e,"aria-copied"),v(e,"draggable"),v(e,"role")};function H(e,t){if(t.composedPath)return t.composedPath().find(function(e){return e.isSortable});for(;!0!==e.isSortable;)e=e.parentElement;return e}function M(t,n){var r=e(t,"opts"),o=f(t.children,r.items).filter(function(e){return e.contains(n)||e.shadowRoot&&e.shadowRoot.contains(n)});return o.length>0?o[0]:n}var R=function(t){var n=e(t,"opts")||{},r=f(t.children,n.items),i=S(r,n.handle);O(t,!1),h(t,"dragover"),h(t,"dragenter"),h(t,"dragstart"),h(t,"dragend"),h(t,"drop"),F(t),h(i,"mousedown"),z(r),q(r),W(o,s),t.isSortable=!1},X=function(t){var n=e(t,"opts"),r=f(t.children,n.items),o=S(r,n.handle);m(t,"aria-dropeffect","move"),e(t,"_disabled","false"),m(o,"draggable","true"),O(t,!0),!1===n.disableIEFix&&"function"==typeof(document||window.document).createElement("span").dragDrop&&g(o,"mousedown",function(){if(-1!==r.indexOf(this))this.dragDrop();else{for(var e=this.parentElement;-1===r.indexOf(e);)e=e.parentElement;e.dragDrop()}})},B=function(t){var n=e(t,"opts"),r=f(t.children,n.items),o=S(r,n.handle);m(t,"aria-dropeffect","none"),e(t,"_disabled","true"),m(o,"draggable","false"),h(o,"mousedown"),O(t,!1)},N=function(t){var n=e(t,"opts"),r=f(t.children,n.items),i=S(r,n.handle);e(t,"_disabled","false"),z(r),W(o,s),h(i,"mousedown"),h(t,"dragover"),h(t,"dragenter"),h(t,"drop")};function k(u,h){var v=String(h);return(h=h||{},"string"==typeof u&&(u=document.querySelectorAll(u)),u instanceof HTMLElement&&(u=[u]),u=Array.prototype.slice.call(u),/serialize/.test(v))?u.map(function(t){var n=e(t,"opts");return E(t,n.itemSerializer,n.containerSerializer)}):(u.forEach(function(u){if(/enable|disable|destroy/.test(v))return k[v](u);["connectWith","disableIEFix"].forEach(function(e){Object.prototype.hasOwnProperty.call(h,e)&&null!==h[e]&&console.warn('HTML5Sortable: You are using the deprecated configuration "'+e+'". This will be removed in an upcoming version, make sure to migrate to the new options when updating.')}),h=Object.assign({},P,p(u).config,h),p(u).config=h,e(u,"opts",h),u.isSortable=!0,N(u);var E,S=f(u.children,h.items);if(null!==h.placeholder&&void 0!==h.placeholder){var _=document.createElement(u.tagName);h.placeholder instanceof HTMLElement?_.appendChild(h.placeholder):_.innerHTML=h.placeholder,E=_.children[0]}p(u).placeholder=T(u,E,h.placeholderClass),e(u,"items",h.items),h.acceptFrom?e(u,"acceptFrom",h.acceptFrom):h.connectWith&&e(u,"connectWith",h.connectWith),X(u),m(S,"role","option"),m(S,"aria-grabbed","false"),g(u,"dragstart",function(e){var s=I(e);if(!0!==s.isSortable){if(e.stopImmediatePropagation(),(!h.handle||s.matches(h.handle))&&"false"!==s.getAttribute("draggable")){var d=H(s,e),c=M(d,s);i=(l=f(d.children,h.items)).indexOf(c),a=$(c,d.children),o=d,L(e,c,h.customDragImage),n=x(c),r=D(c),c.classList.add(h.draggingClass),t=A(c,d),m(t,"aria-grabbed","true"),d.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:a,index:i,container:o},item:t,originalTarget:s}}))}}}),g(u,"dragenter",function(n){var r=I(n),l=H(r,n);l&&l!==s&&(d=f(l.children,e(l,"items")).filter(function(e){return e!==p(u).placeholder}),h.dropTargetContainerClass&&l.classList.add(h.dropTargetContainerClass),l.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:a,index:i,container:o},destination:{container:l,itemsBeforeUpdate:d},item:t,originalTarget:r}})),g(l,"dragleave",function(e){var n=e.relatedTarget||e.fromElement;e.currentTarget.contains(n)||(h.dropTargetContainerClass&&l.classList.remove(h.dropTargetContainerClass),l.dispatchEvent(new CustomEvent("sortleave",{detail:{origin:{elementIndex:a,index:i,container:l},item:t,originalTarget:r}})))})),s=l}),g(u,"dragend",function(l){if(t){t.classList.remove(h.draggingClass),m(t,"aria-grabbed","false"),"true"===t.getAttribute("aria-copied")&&"true"!==e(t,"dropped")&&t.remove(),void 0!==t.oldDisplay&&(t.style.display=t.oldDisplay,delete t.oldDisplay);var d=Array.from(c.values()).map(function(e){return e.placeholder}).filter(function(e){return e instanceof HTMLElement}).filter(w)[0];d&&d.remove(),u.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:a,index:i,container:o},item:t}})),s=null,t=null,n=null,r=null}}),g(u,"drop",function(n){if(Y(u,t.parentElement)){n.preventDefault(),n.stopPropagation(),e(t,"dropped","true");var r=Array.from(c.values()).map(function(e){return e.placeholder}).filter(function(e){return e instanceof HTMLElement}).filter(w)[0];if(r)r.replaceWith(t),void 0!==t.oldDisplay&&(t.style.display=t.oldDisplay,delete t.oldDisplay);else{e(t,"dropped","false");return}u.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:a,index:i,container:o},item:t}}));var s=p(u).placeholder,g=f(o.children,h.items).filter(function(e){return e!==s}),m=!0===this.isSortable?this:this.parentElement,v=f(m.children,e(m,"items")).filter(function(e){return e!==s}),y=$(t,Array.from(t.parentElement.children).filter(function(e){return e!==s})),b=$(t,v);h.dropTargetContainerClass&&m.classList.remove(h.dropTargetContainerClass),(a!==y||o!==m)&&u.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:a,index:i,container:o,itemsBeforeUpdate:l,items:g},destination:{index:b,elementIndex:y,container:m,itemsBeforeUpdate:d,items:v},item:t}}))}});var O=b(function(e,o,i,a){if(t){if(h.forcePlaceholderSize&&(p(e).placeholder.style.height=n+"px",p(e).placeholder.style.width=r+"px"),Array.from(e.children).indexOf(o)>-1){var l,s,d,u,g=x(o),m=D(o),v=$(p(e).placeholder,o.parentElement.children),b=$(o,o.parentElement.children);if(g>n||m>r){var w=g-n,E=m-r,T=y(o).top,S=y(o).left;if(v<b&&("vertical"===h.orientation&&a<T||"horizontal"===h.orientation&&i<S)||v>b&&("vertical"===h.orientation&&a>T+g-w||"horizontal"===h.orientation&&i>S+m-E))return}void 0===t.oldDisplay&&(t.oldDisplay=t.style.display),"none"!==t.style.display&&(t.style.display="none");var I=!1;try{var _=y(o).top+o.offsetHeight/2,L=y(o).left+o.offsetWidth/2;I="vertical"===h.orientation&&a>=_||"horizontal"===h.orientation&&i>=L}catch(Y){I=v<b}I?(l=o,s=p(e).placeholder,C(l,s,"after")):(d=o,u=p(e).placeholder,C(d,u,"before")),Array.from(c.values()).filter(function(e){return void 0!==e.placeholder}).forEach(function(t){t.placeholder!==p(e).placeholder&&t.placeholder.remove()})}else{var P=Array.from(c.values()).filter(function(e){return void 0!==e.placeholder}).map(function(e){return e.placeholder});-1!==P.indexOf(o)||e!==o||f(o.children,h.items).length||(P.forEach(function(e){return e.remove()}),o.appendChild(p(e).placeholder))}}},h.debounce),z=function(n){var r=n.target,o=!0===r.isSortable?r:H(r,n);if(r=M(o,r),t&&Y(o,t.parentElement)&&"true"!==e(o,"_disabled")){var i=e(o,"opts");(!(parseInt(i.maxItems)&&f(o.children,e(o,"items")).length>parseInt(i.maxItems))||t.parentElement===o)&&(n.preventDefault(),n.stopPropagation(),n.dataTransfer.dropEffect=!0===p(o).getConfig("copy")?"copy":"move",O(o,r,n.pageX,n.pageY))}};g(S.concat(u),"dragover",z),g(S.concat(u),"dragenter",z)}),u)}return k.destroy=function(e){R(e)},k.enable=function(e){X(e)},k.disable=function(e){B(e)},k.__testing={data:e,removeItemEvents:z,removeItemData:q,removeSortableData:F,removeContainerEvents:W},k}();
